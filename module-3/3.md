# Модуль 3: Написание SQL-запросов для анализа

Чтобы принимать верные решения, Деду Морозу нужна точная информация. С помощью SQL вы
сможете извлечь из базы данных ценные знания.

Представьте, что SQL – это волшебный язык, который позволяет задавать вопросы базе данных и
получать на них точные ответы.
Как получить ответы на важные вопросы о письмах, подарках и доставке, используя SQL?


Задачи:
1. Написать SQL-запрос, который покажет количество писем по городам.
Дед Мороз хочет знать, из каких городов приходит больше всего писем. Напишите запрос,
который посчитает количество писем из каждого города и отсортирует результаты по
убыванию количества.


```sql
--1
SELECT 
    city_name, COUNT(city_name)
FROM
    Letters
        JOIN
    Cities ON Letters.city_id = Cities.city_id
GROUP BY city_name
ORDER BY 2 DESC;


--2
SELECT 
    city_name, COUNT(city_name)
FROM
    Letters
       NATURAL JOIN
    Cities
GROUP BY city_name
ORDER BY 2 DESC;

```


```
Элиста	122
Самара	121
Новокузнецк	120
Оренбург	118
Сочи	112
Новосибирск	111
Липецк	111
Москва	110
...
Смоленск	85
Уфа	82


```




2. Написать SQL-запрос, который отобразит подарки, количество которых на складе
равно нулю.
Снегурочке нужно знать, какие подарки закончились на складах. 

Напишите запрос, который
выведет список таких подарков.

```sql
SELECT 
    gift_id, gift_name, quantity
FROM
    Gifts
        NATURAL JOIN
    Stocks
WHERE
    quantity = 0
GROUP BY gift_id;

```

```
# gift_id	gift_name	quantity
3	Набор для рисования	0
7	Настольная игра 'Монополия'	0

```



3. Написать SQL-запрос для поиска детей, чьи доставки отменены.

Дед Мороз хочет знать, кому из детей не достанется подарок из-за отмены доставки.
Напишите запрос, который выведет имена этих детей.


```sql
SELECT 
    child_name, child_age
FROM
    Letters
        NATURAL JOIN
    Deliveries
WHERE
    send_date IS NULL
ORDER BY child_name;

```


```
Александр Бабушкин	11
Александр Бабушкин	2
Александр Быков	16
Александр Воробьев	12
Александр Гаврилов	10
Александр Громов	12
Александр Егоров	4
Александр Ершов	11
...
Леонид Шестаков	6
Любовь Артамонова	13


```


4. Написать SQL-запрос, чтобы определить самый популярный подарок.

Дед Мороз хочет знать, какой подарок просят чаще всего. Напишите запрос, который найдет
самый популярный подарок среди всех писем.

```sql
SELECT 
    gift_name, COUNT(letter_id)
FROM
    Gifts
        NATURAL JOIN
    Letters
GROUP BY 1
ORDER BY 2 DESC;


```


