# Модуль 1: Создание структуры базы данных и заполнение данными
50 минут

## Результат

* Создана схема DedMoroz_[номер участника].
* Разработана структура базы данных с учетом принципов нормализации данных и созданы таблицы.
* Создана ER-диаграмма.
* Таблицы заполнены данными.

# Методичка урока для участников Абилимпикс  
**Модуль 1: Создание структуры базы данных и заполнение данными**  
*Длительность: 50 минут*  

---

## Цели урока  
1. Освоить создание схемы базы данных в СУБД MySQL.  
2. Научиться проектировать нормализованную структуру таблиц.  
3. Создать ER-диаграмму для визуализации связей.  
4. Заполнить таблицы тестовыми данными.  

---

## Оборудование и ПО  
- **MySQL Server 8.0+**  
- **MySQL Workbench** (для визуализации ER-диаграмм)  
- **Draw.io** (альтернатива для схем)  

---

## Пошаговый план  

### **1. Создание схемы (5 мин)**  
**Задача:** Создать персональную схему с именем `DedMoroz_[номер]`.  

```sql
-- Шаг 1: Создание схемы
CREATE SCHEMA DedMoroz_123;  -- Замените 123 на ваш номер участника

-- Шаг 2: Активация схемы
USE DedMoroz_123;
```

---

### **2. Проектирование таблиц (15 мин)**  
**Принципы нормализации:**  
- **1NF:** Нет повторяющихся групп данных.  
- **2NF:** Все поля зависят от первичного ключа.  

**Пример структуры для мастерской Деда Мороза:**  

```sql
-- Таблица подарков
CREATE TABLE Gifts (
    gift_id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    category VARCHAR(30),
    weight_kg DECIMAL(5,2)
);

-- Таблица детей
CREATE TABLE Children (
    child_id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    city VARCHAR(30),
    birth_year INT
);

-- Таблица заказов (связь Many-to-Many)
CREATE TABLE Orders (
    order_id INT PRIMARY KEY AUTO_INCREMENT,
    child_id INT,
    gift_id INT,
    order_date DATE,
    FOREIGN KEY (child_id) REFERENCES Children(child_id),
    FOREIGN KEY (gift_id) REFERENCES Gifts(gift_id)
);
```

---

### **3. ER-диаграмма (10 мин)**  
**Инструменты:**  
- **MySQL Workbench:** `Database → Reverse Engineer → Следуйте инструкциям`.  
- **Draw.io:** Ручное создание схемы.  

**Правила:**  
- Прямоугольники = таблицы.  
- Ромбы = связи (1:1, 1:N, N:M).  
- Пример связи:  
  ```
  Children (1) ───────< Orders >─────── (1) Gifts
  ```

---

### **4. Заполнение данными (15 мин)**  
**Шаблон для тестовых данных:**  

```sql
-- Подарки
INSERT INTO Gifts (name, category, weight_kg) 
VALUES ('Конструктор', 'Игрушки', 0.7),
       ('Книга сказок', 'Литература', 0.5),
       ('Мягкая игрушка', 'Игрушки', 0.3);

-- Дети
INSERT INTO Children (name, city, birth_year)
VALUES ('Аня', 'Москва', 2015),
       ('Иван', 'Казань', 2018),
       ('Мария', 'Новосибирск', 2016);

-- Заказы
INSERT INTO Orders (child_id, gift_id, order_date)
VALUES (1, 1, '2023-12-01'),
       (2, 2, '2023-12-02'),
       (3, 3, '2023-12-03');
```

---

### **5. Проверка (5 мин)**  
**Тестовые запросы:**  

```sql
-- Проверка содержимого таблиц
SELECT * FROM Gifts;
SELECT * FROM Children;

-- Пример сложного запроса (дети и их подарки)
SELECT 
    c.name AS child_name, 
    g.name AS gift_name, 
    o.order_date
FROM Orders o
JOIN Children c ON o.child_id = c.child_id
JOIN Gifts g ON o.gift_id = g.gift_id;
```

---

## Критерии оценки  
✅ **Схема:** Создана с правильным именем (`DedMoroz_номер`).  
✅ **Нормализация:** Таблицы соответствуют 1NF и 2NF.  
✅ **ER-диаграмма:** Отражены все таблицы и связи.  
✅ **Данные:** Заполнены минимум 3 записи в каждой таблице.  

---

## Советы  
- Для ускорения используйте **готовые SQL-скрипты**.  
- Проверяйте связи через `FOREIGN KEY` перед вставкой данных.  
- Экспортируйте ER-диаграмму в PNG/PDF для отчета.  

**Пример результата:**  
![ER-диаграмма](https://i.imgur.com/xyz123.png)  

--- 

Файлы для урока:  
- [Шаблон SQL-скрипта](ссылка)  
- [Пример ER-диаграммы](ссылка)


## Домашнее задание

* Создать дополнительную таблицу
* Установить связь с существующей таблицей
* Заполнить новую таблицу данными
* Подготовить описание структуры БД

## Вопросы для самопроверки

* Как создать новую схему в MySQL?
* Какие типы связей поддерживает MySQL?
* Как создать внешний ключ в MySQL?
* Какие типы данных используются в MySQL?
* Как проверить целостность данных в MySQL?

## Полезные сочетания клавиш в MySQL Workbench

* Ctrl+Enter - выполнить текущий запрос
* F5 - обновить схему
* Ctrl+Shift+Alt+R - запустить отладчик
* Ctrl+S - сохранить изменения
* Ctrl+Tab - переключение между вкладками



## Дополнительные материалы


Вот **ER-диаграмма** для базы данных мастерской Деда Мороза, соответствующая уроку:

---

### **ER-диаграмма (сущности и связи)**  
```mermaid
erDiagram
    Children ||--o{ Orders : "1:N"
    Gifts ||--o{ Orders : "1:N"

    Children {
        int child_id PK
        varchar(50) name
        varchar(30) city
        int birth_year
    }

    Gifts {
        int gift_id PK
        varchar(50) name
        varchar(30) category
        decimal(5,2) weight_kg
    }

    Orders {
        int order_id PK
        int child_id FK
        int gift_id FK
        date order_date
    }
```

---

### **Визуализация в Draw.io/MySQL Workbench**  
1. **Таблицы и атрибуты**:  
   - **Children** (`child_id`, `name`, `city`, `birth_year`)  
   - **Gifts** (`gift_id`, `name`, `category`, `weight_kg`)  
   - **Orders** (`order_id`, `child_id`, `gift_id`, `order_date`)  

2. **Связи**:  
   - **Children → Orders**: Один ко многим (1 ребенок может иметь несколько заказов).  
   - **Gifts → Orders**: Один ко многим (1 подарок может быть в нескольких заказах).  

---

### **Как создать диаграмму:**  
#### **В MySQL Workbench**:  
1. Откройте вкладку **Modeling**.  
2. Нажмите **Add Diagram** → перетащите таблицы из панели слева.  
3. Соедините таблицы через **Foreign Keys** (линии со стрелками).  

#### **В Draw.io**:  
1. Выберите шаблон **Entity Relationship**.  
2. Добавьте прямоугольники для таблиц и укажите атрибуты.  
3. Свяжите таблицы линиями с подписями `1:N`.  

---

### **Пример готовой диаграммы**  
![Пример ER-диаграммы](https://i.imgur.com/JQ1wz9L.png)  
*(Скачайте изображение для печати или отчета.)*  

---

### **Правила для участников**:  
1. **Первичные ключи** (`PK`) должны быть подчеркнуты.  
2. **Внешние ключи** (`FK`) указывают на связь с другой таблицей.  
3. **Типы данных** (INT, VARCHAR) пишутся рядом с атрибутами.  

Файлы для работы:  
- [Шаблон Draw.io](https://app.diagrams.net/)  
- [Готовый SQL-скрипт с CREATE TABLE](https://pastebin.com/xyz123)  

Диаграмма соответствует принципам **нормализации** (1NF, 2NF) и готова для использования в уроке.